<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BonjourArcade - Jeu de la semaine</title>
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://bonjourarcade.com/">
    <meta property="og:title" content="BonjourArcade - Jeu de la semaine">
    <meta property="og:description" content="Chargement...">
    <meta property="og:image" content="https://bonjourarcade.com/assets/images/bonjourarcade-logo.png">
    
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://bonjourarcade.com/">
    <meta property="twitter:title" content="BonjourArcade - Jeu de la semaine">
    <meta property="twitter:description" content="Chargement...">
    <meta property="twitter:image" content="https://bonjourarcade.com/assets/images/bonjourarcade-logo.png">
    
    <link rel="stylesheet" href="assets/css/style.css">
</head>
<body>
    <div id="browser-warning" class="browser-warning" style="display: none;">
      <!-- Browser compatibility message will be inserted here by JavaScript if needed -->
    </div>
    <div class="container">
        <header>
            <div class="header-flex">
                <button id="random-game-btn" class="random-game-btn">Jouer au hasard</button>
                <div class="game-launcher">
                    <input type="text" id="game-id-input"
                    placeholder="Recherche">
                    <!-- <button id="launch-game-btn">Lancer</button> -->
                </div>
                <img src="assets/images/bonjourarcade-logo.png" alt="BonjourArcade Logo" class="header-logo">
                <div class="header-actions">
                    <a target="_blank" id="leaderboard-link"
                      href="https://felx.cc/leaderboard">Classements</a>
                    <img src="assets/images/my_app_qr.png" alt="QR Code" class="static-qr-code">
                </div>
                <button id="theme-toggle-btn" style="margin-top:10px;font-size:1.5em;background:none;border:none;cursor:pointer;" aria-label="Switch theme">
                  <svg id="theme-toggle-icon" width="28" height="28" viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg" style="vertical-align:middle;">
                    <circle cx="14" cy="14" r="12" stroke="#222" stroke-width="2" fill="#222"/>
                    <rect x="14" y="0" width="13" height="27" fill="#fff"/>
                  </svg>
                </button>
            </div>
        </header>

        <main class="main-content">
            <section id="game-of-the-week" class="featured-section">
              <center><h2>Jeu de la semaine</h2></center>
                <div id="featured-game-content" class="featured-content-vertical">
                    <img id="featured-game-img"
                         src="" alt="Couverture du jeu s√©lectionn√©">
                    <div id="featured-game-title" class="featured-title">
                        Chargement...
                    </div>
                </div>
            </section>

            <section id="previous-games" class="grid-section">
                <div id="previous-games-grid" class="game-grid">
                    <p>Chargement des jeux...</p>
                </div>
            </section>
        </main>
    </div>
    <!-- <div class="all-games-link-container bottom-link">
        <a href="/all" class="all-games-link">
            <span class="joystick-emoji">üïπÔ∏è</span>
        </a>
    </div> -->

    <script src="assets/js/screensaver.js"></script>
    <script src="assets/js/main.js"></script>

    <!--This is for loading custom cursors-->
    <script src="https://unpkg.com/cursor-effects@latest/dist/browser.js"></script>
    <script>
      window.addEventListener("load", (event) => {
        // Available cursors are found here: https://github.com/tholman/cursor-effects/tree/master/src
        // Ensure cursor effects are on top of everything
        //const rainbowCursor = new cursoreffects.rainbowCursor();
        //const fairyDustCursor = new cursoreffects.fairyDustCursor();
        const springyEmojiCursor = new cursoreffects.springyEmojiCursor({ emoji: "üíõ" });
        
        // Set high z-index for cursor effects with a small delay to ensure they're created
        setTimeout(() => {
            const cursorElements = document.querySelectorAll('.cursor-effects');
            cursorElements.forEach(element => {
                element.style.zIndex = '99999';
                element.style.pointerEvents = 'none';
            });
        }, 100);
      });
    // Game launcher functionality
    /*
    document.getElementById('launch-game-btn').addEventListener('click', function() {
        const gameId = document.getElementById('game-id-input').value.trim();
        if (gameId) {
            window.location.href = `/play?game=${gameId}`;
        }
    });

    // Allow Enter key to launch game as well
    document.getElementById('game-id-input').addEventListener('keypress', function(event) {
        if (event.key === 'Enter') {
            document.getElementById('launch-game-btn').click();
        }
    });
    */

    // Theme toggling logic
    function setTheme(theme) {
        document.body.classList.remove('theme-light', 'theme-dark');
        document.body.classList.add(theme);
        // Update icon
        const icon = document.getElementById('theme-toggle-icon');
        if (icon) {
          if (theme === 'theme-dark') {
            icon.querySelector('circle').setAttribute('stroke', '#f4f4f4');
            icon.querySelector('circle').setAttribute('fill', '#f4f4f4');
            icon.querySelector('rect').setAttribute('fill', '#222');
          } else {
            icon.querySelector('circle').setAttribute('stroke', '#222');
            icon.querySelector('circle').setAttribute('fill', '#222');
            icon.querySelector('rect').setAttribute('fill', '#fff');
          }
        }
    }
    function getSystemTheme() {
        return window.matchMedia('(prefers-color-scheme: dark)').matches ? 'theme-dark' : 'theme-light';
    }
    // On load: use localStorage or system preference
    const savedTheme = localStorage.getItem('theme');
    const initialTheme = savedTheme || getSystemTheme();
    setTheme(initialTheme);
    // Toggle button
    document.getElementById('theme-toggle-btn').onclick = function() {
        const current = document.body.classList.contains('theme-dark') ? 'theme-dark' : 'theme-light';
        const next = current === 'theme-dark' ? 'theme-light' : 'theme-dark';
        setTheme(next);
        localStorage.setItem('theme', next);
    };
    // Listen for system theme changes if user hasn't chosen
    if (!savedTheme) {
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', e => {
            setTheme(e.matches ? 'theme-dark' : 'theme-light');
        });
    }
    </script>
    <script>
    // --- Auto-refresh every 3 hours, and auto-restart screensaver if it was active before refresh ---
    (function() {
      // Refresh every 3 hours (10,800,000 ms)
      const THREE_HOURS_MS = 3 * 60 * 60 * 1000;
      setTimeout(() => {
        // If screensaver is active, set a flag before reload
        if (window.screensaverActive) {
          sessionStorage.setItem('bonjourarcade_screensaver_was_active', '1');
        }
        location.reload();
      }, THREE_HOURS_MS);

      // On load, if the flag is set, start the screensaver after DOM is ready
      document.addEventListener('DOMContentLoaded', function() {
        if (sessionStorage.getItem('bonjourarcade_screensaver_was_active') === '1') {
          sessionStorage.removeItem('bonjourarcade_screensaver_was_active');
          // Wait a tick to ensure screensaver.js is initialized
          setTimeout(function() {
            if (typeof startScreensaver === 'function') {
              startScreensaver();
            }
          }, 300);
        }
      });
    })();
    </script>
    <div id="screensaver-overlay" class="screensaver-overlay">
        <img id="screensaver-image" class="screensaver-image" src="" alt="Screensaver Image">
        <img id="screensaver-logo" class="screensaver-logo" src="" alt="BonjourArcade Logo">
    </div>
    <footer>
      <a href="/all" class="footer-emoji-link" title="Voir tous les jeux" aria-label="Voir tous les jeux">üîë</a>
    </footer>
</body>
</html>
