<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BonjourArcade - Jeu de la semaine</title>
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://bonjourarcade.com/">
    <meta property="og:title" content="BonjourArcade - Jeu de la semaine">
    <meta property="og:description" content="Chargement...">
    <meta property="og:image" content="https://bonjourarcade.com/assets/images/bonjourarcade-logo.png">
    
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://bonjourarcade.com/">
    <meta property="twitter:title" content="BonjourArcade - Jeu de la semaine">
    <meta property="twitter:description" content="Chargement...">
    <meta property="twitter:image" content="https://bonjourarcade.com/assets/images/bonjourarcade-logo.png">
    
    <link rel="stylesheet" href="assets/css/style.css">
</head>
<body>
    <div id="browser-warning" class="browser-warning" style="display: none;">
      <!-- Browser compatibility message will be inserted here by JavaScript if needed -->
    </div>
    <div class="container">
        <header>
            <div class="header-flex">
                <button id="random-game-btn" class="random-game-btn">Jouer au hasard</button>
                <button id="newsletter-subscribe" class="newsletter-btn">📧 S’abonner à la newsletter</button>
                <div class="game-launcher">
                    <input type="text" id="game-id-input"
                    placeholder="Recherche">
                    <!-- <button id="launch-game-btn">Lancer</button> -->
                </div>
                <img src="assets/images/bonjourarcade-logo.png" alt="BonjourArcade Logo" class="header-logo">
                <div class="header-actions">
                    <a target="_blank" id="leaderboard-link"
                      href="https://felx.cc/leaderboard">Classements</a>
                    <img src="assets/images/my_app_qr.png" alt="QR Code" class="static-qr-code">
                </div>
                <div style="position: relative;">
                  <button id="theme-toggle-btn" class="theme-btn" aria-label="Changer le thème" type="button">
                    <span id="theme-toggle-icon" style="display:inline-flex;align-items:center;font-size:1.2em;">🌓</span>
                    <span id="theme-toggle-label">Thème</span>
                  </button>
                  <div id="theme-dropdown" style="display:none;position:absolute;top:110%;left:50%;transform:translateX(-50%);background:#222;color:#fff;border:1px solid #444;border-radius:8px;box-shadow:0 4px 16px #0002;min-width:170px;z-index:10000;padding:8px 0;">
                    <button class="theme-option" data-theme="system" style="display:flex;align-items:center;width:100%;background:none;border:none;color:inherit;font:inherit;padding:8px 18px;gap:10px;cursor:pointer;"><span style='font-size:1.2em;'>🌓</span>Système</button>
                    <button class="theme-option" data-theme="light" style="display:flex;align-items:center;width:100%;background:none;border:none;color:inherit;font:inherit;padding:8px 18px;gap:10px;cursor:pointer;"><span style='font-size:1.2em;'>☀️</span>Clair</button>
                    <button class="theme-option" data-theme="dark" style="display:flex;align-items:center;width:100%;background:none;border:none;color:inherit;font:inherit;padding:8px 18px;gap:10px;cursor:pointer;"><span style='font-size:1.2em;'>🌙</span>Sombre</button>
                  </div>
                </div>
            </div>
        </header>

        <main class="main-content">
            <section id="game-of-the-week" class="featured-section">
              <center><h2>Jeu de la semaine</h2></center>
                <div id="featured-game-content" class="featured-content-vertical">
                    <img id="featured-game-img"
                         src="" alt="Couverture du jeu sélectionné">
                    <div id="featured-game-title" class="featured-title">
                        Chargement...
                    </div>
                </div>
            </section>

            <section id="previous-games" class="grid-section">
                <div id="previous-games-grid" class="game-grid">
                    <p>Chargement des jeux...</p>
                </div>
            </section>
        </main>
    </div>
    <!-- <div class="all-games-link-container bottom-link">
        <a href="/all" class="all-games-link">
            <span class="joystick-emoji">🕹️</span>
        </a>
    </div> -->

    <script src="assets/js/screensaver.js"></script>
    <script src="assets/js/main.js"></script>

    <!--This is for loading custom cursors-->
    <script src="https://unpkg.com/cursor-effects@latest/dist/browser.js"></script>
    <script>
      window.addEventListener("load", (event) => {
        // Only enable cursor effects on non-mobile devices
        if (!/Mobi|Android|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)) {
          const springyEmojiCursor = new cursoreffects.springyEmojiCursor({ emoji: "💛" });
          setTimeout(() => {
            const cursorElements = document.querySelectorAll('.cursor-effects');
            cursorElements.forEach(element => {
              element.style.zIndex = '99999';
              element.style.pointerEvents = 'none';
            });
          }, 100);
        }
      });
    // Game launcher functionality
    /*
    document.getElementById('launch-game-btn').addEventListener('click', function() {
        const gameId = document.getElementById('game-id-input').value.trim();
        if (gameId) {
            window.location.href = `/play?game=${gameId}`;
        }
    });

    // Allow Enter key to launch game as well
    document.getElementById('game-id-input').addEventListener('keypress', function(event) {
        if (event.key === 'Enter') {
            document.getElementById('launch-game-btn').click();
        }
    });
    */

    // Theme toggling logic
    function setTheme(theme) {
        document.body.classList.remove('theme-light', 'theme-dark');
        let classToAdd;
        if (theme === 'system') {
          classToAdd = getSystemTheme();
        } else if (theme === 'dark') {
          classToAdd = 'theme-dark';
        } else {
          classToAdd = 'theme-light';
        }
        document.body.classList.add(classToAdd);
        // Update button icon and label
        const icon = document.getElementById('theme-toggle-icon');
        const label = document.getElementById('theme-toggle-label');
        if (icon && label) {
          if (theme === 'dark') {
            icon.textContent = '🌙';
            label.textContent = 'Sombre';
          } else if (theme === 'light') {
            icon.textContent = '☀️';
            label.textContent = 'Clair';
          } else {
            icon.textContent = '🌓';
            label.textContent = 'Thème';
          }
        }
        // Highlight current in dropdown
        document.querySelectorAll('.theme-option').forEach(btn => {
          btn.style.background = (btn.dataset.theme === theme) ? '#444' : 'none';
        });
        // Update button style for dark/light
        const themeBtn = document.getElementById('theme-toggle-btn');
        if (themeBtn) {
          if (classToAdd === 'theme-dark') {
            themeBtn.style.background = '#222';
            themeBtn.style.color = '#fff';
            themeBtn.style.border = '1px solid #fff2';
          } else {
            themeBtn.style.background = '#fff';
            themeBtn.style.color = '#111';
            themeBtn.style.border = '1px solid #ccc';
          }
        }
    }

    function getSystemTheme() {
        return window.matchMedia('(prefers-color-scheme: dark)').matches ? 'theme-dark' : 'theme-light';
    }

    // Dropdown logic
    const themeBtn = document.getElementById('theme-toggle-btn');
    const themeDropdown = document.getElementById('theme-dropdown');
    themeBtn.addEventListener('click', function(e) {
      e.stopPropagation();
      themeDropdown.style.display = (themeDropdown.style.display === 'block') ? 'none' : 'block';
    });
    document.addEventListener('click', function(e) {
      if (themeDropdown.style.display === 'block') themeDropdown.style.display = 'none';
    });
    themeDropdown.addEventListener('click', function(e) { e.stopPropagation(); });
    document.querySelectorAll('.theme-option').forEach(btn => {
      btn.addEventListener('click', function() {
        const selected = btn.dataset.theme;
        if (selected === 'system') {
          localStorage.removeItem('theme');
        } else {
          localStorage.setItem('theme', selected);
        }
        setTheme(selected);
        themeDropdown.style.display = 'none';
      });
    });

    // On load: use localStorage or system preference
    const savedTheme = localStorage.getItem('theme');
    const initialTheme = savedTheme || 'system';
    setTheme(initialTheme);
    // Listen for system theme changes if user hasn't chosen
    if (!savedTheme) {
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', e => {
            setTheme('system');
        });
    }
    </script>
    <script>
    // --- Auto-refresh every 3 hours, and auto-restart screensaver if it was active before refresh ---
    (function() {
      // Refresh every 3 hours (10,800,000 ms)
      const THREE_HOURS_MS = 3 * 60 * 60 * 1000;
      setTimeout(() => {
        // If screensaver is active, set a flag before reload
        if (window.screensaverActive) {
          sessionStorage.setItem('bonjourarcade_screensaver_was_active', '1');
        }
        location.reload();
      }, THREE_HOURS_MS);

      // On load, if the flag is set, start the screensaver after DOM is ready
      document.addEventListener('DOMContentLoaded', function() {
        if (sessionStorage.getItem('bonjourarcade_screensaver_was_active') === '1') {
          sessionStorage.removeItem('bonjourarcade_screensaver_was_active');
          // Wait a tick to ensure screensaver.js is initialized
          setTimeout(function() {
            if (typeof startScreensaver === 'function') {
              startScreensaver();
            }
          }, 300);
        }
      });
    })();
    </script>
    <div id="screensaver-overlay" class="screensaver-overlay">
        <img id="screensaver-image" class="screensaver-image" src="" alt="Screensaver Image">
        <img id="screensaver-logo" class="screensaver-logo" src="" alt="BonjourArcade Logo">
    </div>

    <!-- Newsletter Subscription Modal -->
    <!-- The newsletter modal and form HTML have been removed. -->
    <footer>
      <a href="/all" class="footer-emoji-link" title="Voir tous les jeux" aria-label="Voir tous les jeux">🔑</a>
      <a href="#" id="newsletter-subscribe" class="footer-emoji-link" title="S'abonner à la newsletter" aria-label="S'abonner à la newsletter">📧</a>
    </footer>
</body>
</html>
